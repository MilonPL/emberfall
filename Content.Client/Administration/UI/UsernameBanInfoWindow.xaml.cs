using Content.Shared.Administration;
using Robust.Client.AutoGenerated;
using Robust.Client.Console;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Administration.UI;

[GenerateTypedNameReferences]
public sealed partial class UsernameBanInfoWindow : DefaultWindow
{
    private int _banId;
    public UsernameBanInfoWindow(BanUsernamePanelEuiMsg.FullUsernameRuleInfoReply ban)
    {
        _banId = ban.Id;
        RobustXamlLoader.Load(this);
        UsernameBanIdContentLabel.Text = $"{ban.Id}";
        RegexCheckbox.Pressed = ban.Regex;
        UsernameBanExpressionContentLabel.Text = $"{ban.Expression}";
        ExtendToBanCheckbox.Pressed = ban.ExtendToBan;

        CreatingAdminContentLabel.Text = $"{ban.RestrictingAdmin}";
        CreateTimeContentLabel.Text = $"{ban.CreationTime}";
        RoundIdContentLabel.Text = $"{ban.RoundId}";

        RetiredCheckbox.Pressed = ban.Retired;

        RetiringAdminContentLabel.Text = $"{ban.RetiringAdmin}";
        RetireTimeContentLabel.Text = $"{ban.RetireTime}";

        MessageContentLabel.Text = $"{ban.Message}";

        PardonButton.OnPressed += _ => OnPardonPressed();
    }

    private void OnPardonPressed()
    {
        IoCManager.Resolve<IClientConsoleHost>().ExecuteCommand($"pardonusername {_banId}");
    }


}
