using Content.Shared.Administration;
using Robust.Client.AutoGenerated;
using Robust.Client.Console;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Administration.UI;

[GenerateTypedNameReferences]
public sealed partial class UsernameBanInfoWindow : DefaultWindow
{
    private int _banId;
    public UsernameBanInfoWindow(MsgFullUsernameBanContent ban)
    {
        _banId = ban.Id;
        RobustXamlLoader.Load(this);
        UsernameBanIdLabel.Text = $"Id: {ban.Id}";
        RegexCheckbox.Pressed = ban.Regex;
        UsernameBanExpressionLabel.Text = $"Expression: {ban.Expression}";
        ExtendToBanCheckbox.Pressed = ban.ExtendToBan;

        CreatingAdminLabel.Text = $"Created by: {ban.RestrictingAdmin}";
        CreateTimeLabel.Text = $"Created: {ban.CreationTime}";
        RoundIdLabel.Text = $"Round Id: {ban.RoundId}";

        RetiredCheckbox.Pressed = ban.Retired;

        RetiringAdminLabel.Text = $"Retired by: {ban.RetiringAdmin}";
        RetireTimeLabel.Text = $"Retired: {ban.RetireTime}";

        MessageLabel.Text = $"Message: {ban.Message}";

        PardonButton.OnPressed += _ => OnPardonPressed();
    }

    private void OnPardonPressed()
    {
        IoCManager.Resolve<IClientConsoleHost>().ExecuteCommand($"pardonusername {_banId}");
    }


}
