using Robust.Client.AutoGenerated;
using Robust.Client.Console;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Administration.UI.CustomControls;

[GenerateTypedNameReferences]
public sealed partial class UsernameBanListEntry : BoxContainer
{
    public UsernameBanListEntry()
    {
        RobustXamlLoader.Load(this);
    }

    public void Setup((int, string, bool, bool) usernameBan)
    {
        Update(usernameBan);
        PardonUsernameBanButton.OnPressed += HandlePardonPressed(usernameBan);
    }

    private Action<BaseButton.ButtonEventArgs> HandlePardonPressed((int, string, bool, bool) usernameBan)
    {
        return args =>
        {
            IoCManager.Resolve<IClientConsoleHost>().ExecuteCommand($"pardonusername {usernameBan.Item1}");
        };
    }

    private void Update((int, string, bool, bool) usernameBan)
    {
        (int id, string rule, bool regex, bool extendToBan) = usernameBan;
        UsernameBanEntryLabel.Text = $"{id} {rule}";
        if (regex)
        {
            UsernameBanEntryLabel.FontColorOverride = Color.Yellow;
        }
    }
}